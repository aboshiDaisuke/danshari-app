# 🔧 Google Drive連携 セットアップガイド

この断捨離アプリでGoogleドライブに写真を自動保存するための設定手順です。

## ✅ 完全無料で使えます

- Google Cloud Consoleは無料で使用できます
- クレジットカード登録は不要です
- 個人利用の範囲内であれば課金されません

## 📝 セットアップ手順（5分）

### 1. Google Cloud Consoleにアクセス

[Google Cloud Console](https://console.cloud.google.com) を開きます。

### 2. 新しいプロジェクトを作成

1. 画面上部の「プロジェクトを選択」をクリック
2. 「新しいプロジェクト」をクリック
3. プロジェクト名: `Danshari-App`（任意の名前でOK）
4. 「作成」をクリック

### 3. Google Drive APIを有効化

1. 左メニューの「APIとサービス」→「ライブラリ」を選択
2. 検索ボックスに「Google Drive API」と入力
3. 「Google Drive API」をクリック
4. 「有効にする」をクリック

### 4. OAuth同意画面の設定

1. 左メニューの「APIとサービス」→「OAuth同意画面」を選択
2. ユーザータイプ:
   - **外部**を選択（個人利用の場合）
   - 「作成」をクリック

3. アプリ情報を入力:
   - **アプリ名**: `Danshari`（任意の名前）
   - **ユーザーサポートメール**: あなたのGmailアドレス
   - **デベロッパーの連絡先情報**: あなたのGmailアドレス
   - 「保存して次へ」をクリック

4. スコープ（2ページ目）:
   - 「保存して次へ」をクリック（設定不要）

5. テストユーザー（3ページ目）:
   - 「+ ADD USERS」をクリック
   - あなたのGmailアドレスを入力
   - 「追加」をクリック
   - 「保存して次へ」をクリック

6. 概要（4ページ目）:
   - 「ダッシュボードに戻る」をクリック

### 5. OAuth 2.0クライアントIDを作成

1. 左メニューの「APIとサービス」→「認証情報」を選択
2. 上部の「+認証情報を作成」をクリック
3. 「OAuth クライアント ID」を選択

4. アプリケーションの種類:
   - **ウェブ アプリケーション**を選択

5. 名前:
   - `Danshari Web Client`（任意の名前）

6. **承認済みのJavaScript生成元**:
   - 「+ URIを追加」をクリック
   - 以下を入力（使用環境に応じて）:

   **ローカル開発の場合:**
   ```
   http://localhost:5500
   http://localhost:8080
   http://127.0.0.1:5500
   ```

   **本番環境（Webサイト）の場合:**
   ```
   https://あなたのドメイン.com
   ```

   **ファイルから直接開く場合:**
   ```
   null
   ```

7. 「作成」をクリック

8. **重要**: ダイアログに表示される**クライアントID**をコピーします
   - 形式: `xxxxx.apps.googleusercontent.com`
   - このIDは後で使用します

### 6. アプリでの設定

1. 断捨離アプリを開く
2. 画面右上の設定（⚙️）アイコンをクリック
3. 「☁️ Googleドライブ連携」セクションを見つける
4. クライアントIDの入力欄に、コピーした**クライアントID**を貼り付け
5. 「設定を保存してログイン」をクリック
6. ページがリロードされます
7. 右上の「ログイン」ボタンをクリック
8. Googleアカウントでログイン
9. 権限の許可画面で「許可」をクリック

### 7. 完了！

- ログイン後、アイテムを追加すると自動的にGoogleドライブに保存されます
- Googleドライブ内に「Danshari_App」フォルダが作成されます
- 複数のデバイスで同じGoogleアカウントでログインすれば、データが同期されます

## 🔐 セキュリティ

- **APIキーは不要**: OAuth 2.0のみ使用（より安全）
- **最小限の権限**: アプリが作成したファイルのみアクセス可能
- **データの所有権**: すべてのデータはあなたのGoogleドライブに保存されます

## 👥 複数人で使う場合

1. 各ユーザーが自分のGoogleアカウントでログイン
2. 同じクライアントIDを共有して使用
3. 各ユーザーのデータは個別に保存されます

## ❓ よくある質問

### Q: クライアントIDは人に教えても大丈夫？

A: はい、クライアントIDは公開情報です。GitHubなどで公開しても問題ありません。

### Q: テストユーザーに追加していないと使えない？

A: はい、OAuth同意画面が「テスト」状態の間は、追加したテストユーザーのみログインできます。

### Q: 他の人にも使ってもらいたい

A: テストユーザーとして追加（最大100人）するか、OAuth同意画面を「本番」に移行します（Googleの審査が必要）。

### Q: 「このアプリはGoogleで確認されていません」と表示される

A: テストモードの場合は正常です。「詳細」→「Danshari（安全ではないページ）に移動」をクリックしてください。

### Q: 承認済みのJavaScript生成元とは？

A: アプリを実行するURLのことです。例:
- ローカル: `http://localhost:5500`
- GitHub Pages: `https://username.github.io`
- 独自ドメイン: `https://example.com`

### Q: 複数のURLを追加できる？

A: はい、開発用と本番用など、複数のURLを追加できます。

### Q: エラーが出る場合は？

以下を確認してください:
1. Google Drive APIが有効になっているか
2. OAuth同意画面でテストユーザーに自分のメールアドレスが追加されているか
3. 承認済みのJavaScript生成元に正しいURLが設定されているか
4. ブラウザのコンソールでエラーメッセージを確認

## 📱 スマホでも使える？

はい！ただし以下の点に注意:

- HTTPSまたはlocalhostが必要です
- ファイルから直接開く場合は制限があります
- ブラウザ（Chrome, Safari）で開くことを推奨

## 🆓 本当に無料？

はい、以下の範囲内であれば完全無料です:

- **Google Drive API**: 1日あたり1,000,000リクエスト（通常使用では十分）
- **Googleドライブストレージ**: 無料プランは15GB
- **OAuth認証**: 無料

個人利用や小規模な家族共有であれば、課金される心配はありません。

## 🔄 データの同期

- 同じGoogleアカウントでログインすれば、別のデバイスでもデータにアクセスできます
- リアルタイム同期ではなく、アイテム追加時に自動保存されます
- ローカル（IndexedDB）とGoogleドライブの両方に保存されます

## 📞 サポート

問題が発生した場合:
1. ブラウザのコンソールを確認（F12 → Console）
2. Google Cloud Consoleの設定を再確認
3. GitHubのIssuesで質問（リンクがあれば）

---

設定完了後は、快適な断捨離ライフをお楽しみください！🍃
